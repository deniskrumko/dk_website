<div class="uk-container uk-container-small dk-track-container">
  {% if track.is_new %}
    <span class="uk-label dk-new uk-visible@s">New</span>
  {% endif %}
  <div class="uk-child-width-1-1@s" uk-grid>
    <div class="uk-card uk-card-default uk-grid-collapse uk-margin uk-background-muted" uk-grid>
      <div class="uk-card-media-left uk-background-cover
                  uk-width-2-5@l uk-width-1-4@m uk-width-1-3@s uk-width-1-3"
            style="background-image: url('{{ track.image.url }}');">
        <canvas width="300" height="300"></canvas>
      </div>
      <div class="uk-width-3-5@l uk-width-3-4@m uk-width-2-3@s uk-width-2-3">
        <div class="uk-card-body">
          {# Track name #}
          <h3 class="uk-card-title dk-track-name">
            {{ track.name }}
          </h3>

          {# Track year #}
          <p class="uk-card-title dk-track-year">
            {{ track.year }}
          </p>

          {# Track description #}
          <div class="dk-track-description">
            {% autoescape off %} {{ track.short_description }} {% endautoescape %}
          </div>

          {# Play/pause button #}
          <button type="button" name="button" id="play-track-{{ forloop.counter }}" data-track="track-{{ forloop.counter }}" class="uk-button uk-button-default dk-play-button">
            Play
          </button>

          {# Details button (desktop) #}
          <a href="{% url 'music:details' track.slug %}" target="-_blank" class="uk-button uk-button-text dk-desktop-details">
            Подробнее
          </a>

          {# Details button (mobile) #}
          <a href="{% url 'music:details' track.slug %}" class="uk-button uk-button-default dk-mobile-details" uk-icon="more"></a>
        </div>
      </div>

      {# Player #}
      <div class="uk-width-3-5@l uk-width-3-4@m uk-width-2-3@s uk-width-2-3 dk-player-timeline">
        <!--HTML5 audio-->
        <audio id="track-{{ forloop.counter }}"
          {% if not forloop.last %}
            data-next="track-{{ forloop.counter|add:'1' }}"
          {% endif %}
          {% if not forloop.first %}
            data-prev="track-{{ forloop.counter|add:'-1' }}"
          {% endif %}
            data-artist="{{ track.artist.name }}"
            data-name="{{ track.name }}"
          preload="true">
          <source src="{{ track.file.data.url }}">
        </audio>
        <div class="dk-player-position"></div>
        <div class="dk-player-time"></div>
      </div>
    </div>
  </div>
</div>
